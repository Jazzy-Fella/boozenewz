<tbody id="deals-body">
  <script>
    fetch('deals.json')
      .then(response => response.json())
      .then(data => {
        const tbody = document.getElementById('deals-body');
        data.forEach(deal => {
          const tr = document.createElement('tr');

          // PRODUCT LINK
          const productTd = document.createElement('td');
          productTd.classList.add('product-link');
          const productLink = document.createElement('a');
          productLink.href = deal.link;
          productLink.textContent = deal.title;
          productLink.target = '_blank';
          productTd.appendChild(productLink);
          tr.appendChild(productTd);

          // --- NEW: Determine what to show in Price vs Promo Price ---
          // Start with the raw values
          let priceText = deal.price;
          let promoText = deal.promotion || '';

          // If this is an ASDA deal and promo starts with "was"
          if (deal.store.toLowerCase() === 'asda' &&
              promoText.trim().toLowerCase().startsWith('was')) {
            // Strip off the "was" and any leading spaces
            const originalPrice = promoText.trim().replace(/^was\s*/i, '');
            // Swap them
            priceText = originalPrice;
            promoText = deal.price;
          }

          // PRICE
          const priceTd = document.createElement('td');
          priceTd.classList.add('price');
          priceTd.textContent = priceText;
          tr.appendChild(priceTd);

          // PROMO PRICE
          const promoTd = document.createElement('td');
          promoTd.classList.add('promotion');
          promoTd.textContent = promoText;
          promoTd.style.color = 'white';
          tr.appendChild(promoTd);

          // SAVING
          const savingTd = document.createElement('td');
          savingTd.classList.add('saving');
          savingTd.textContent = deal.saving !== null
            ? `Â£${deal.saving.toFixed(2)}`
            : '';
          savingTd.style.color = 'yellow';
          tr.appendChild(savingTd);

          // For filtering
          tr.dataset.store = deal.store.toLowerCase();
          tbody.appendChild(tr);
        });
      });
  </script>
</tbody>
